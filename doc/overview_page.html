<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Foundation Library: Overview of the design principles and general api patterns</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Foundation Library
   &#160;<span id="projectnumber">1.2.6</span>
   </div>
   <div id="projectbrief">Cross-platform application foundation library in C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Overview</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Overview of the design principles and general api patterns </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="design_principles"></a>
Design principles</h1>
<p>This library provides a cross-platform foundation library in C providing basic support data types and functions to write applications and games in a platform-independent fashion. It is written with the following API design principles in mind:</p>
<ul>
<li>
<b>Consistent</b>: All functions, parameters and types should follow a well defined pattern in order to make it easy to remember how function names are constructed and how to pass the expected parameters. </li>
<li>
<b>Orthogonal</b>: A function should not have any side effects, and there should be only one way to perform an operation in the system. </li>
<li>
<b>Specialized</b>: A function in an API should perform a single task. Functions should not do completely different unrelated tasks or change behaviour depending on the contents of the variables passed in. </li>
<li>
<b>Compact</b>: The API needs to be compact, meaning the user can use it without using a manual. Note though that "compact" does not mean "small". A consistent naming scheme makes the API easier to use and remember. </li>
<li>
<b>Contained</b>: Third party dependencies are kept to an absolute minimum and prefer to use primitive or well-defined data types. </li>
</ul>
<p>Each submodule is contained in one header/source file pair, with all function names beginning with the submodule name. For example, all calls related to bit buffers are contained in <a class="el" href="bitbuffer_8h.html" title="Bit buffer I/O. ">bitbuffer.h</a> and have the format "bitbuffer_&lt;function&gt;( bitbuffer_t*, ... )". If the function call requires a data object related to the submodule (in this case, <a class="el" href="structbitbuffer__t.html" title="Bit buffer. ">bitbuffer_t</a>) a pointer to the object is always the first function argument.</p>
<h1><a class="anchor" id="data_types"></a>
Data types</h1>
<p>The library uses standard C data types (char, unsigned int, ...) where exact data type size is not required, and standard integer types (int16_t, uint64_t) where explicit size is required. The library extends these types with floating point data types:</p>
<ul>
<li>
<em>float32_t</em>, <em>float64_t</em> for explicit size floating point data </li>
<li>
<em>real</em> for a configurable generic floating point data type </li>
</ul>
<p>To set the <em>real</em> data type format set the <a class="el" href="platform_8h.html#a9ab8268069bafca1b9af8d774b839767" title="Size of real type. ">FOUNDATION_SIZE_REAL</a> preprocessor macro to 32 or 64, or change the defined value in <a class="el" href="platform_8h.html" title="Platform abstractions. ">platform.h</a> (default is 32 bit floating point values).</p>
<h1><a class="anchor" id="object_lifetime"></a>
Object lifetime</h1>
<p>Complex data types (objects) are handled in two ways. Either the caller have explicit lifetime control and accessed through raw pointers, or else has implicit control where the lifetime is handled by reference counting and accessed through object handles of type object_t (basically a 64-bit handle mapping into a lookup table).</p>
<p>Explicit allocations are always handled by function calls of the format <em>&lt;module&gt;_t* &lt;module&gt;_allocate(...)</em> to allocate the object and <em>void &lt;module&gt;_deallocate(&lt;module&gt;_t* ptr)</em> to deallocate it, for example md5_allocate and md5_deallocate in <a class="el" href="md5_8h.html" title="MD5 algorithm. ">md5.h</a>. The corresponding calls for initializing/finalizing a struct places on the stack is <em>void &lt;module&gt;_initialize(&lt;module&gt;_t* ptr)</em> and <em>void &lt;module&gt;_initialize(&lt;module&gt;_t* ptr)</em>. All objects that are initialized must be finalized in order to free any allocated resources correctly. Objects that are allocated on the heap with allocate/deallocate should not be initialized/finalized as this is done implicitly by the allocation and deallocation.</p>
<p>Implicit allocators are always handled by function calls of the format <em>object_t &lt;module&gt;_create(...)</em> to allocate a new object, <em>&lt;module&gt;_ref(object_t id)</em> to explicitly add a new reference to an existing object and <em>void &lt;module&gt;_destroy(object_t id)</em> to release a reference to an existing object (and implicitly deallocate it when reference count reaches zero), for example <a class="el" href="thread_8h.html#aec1500740cfddde79e2a2338929fddd0" title="Create thread. ">thread_create</a>, <a class="el" href="thread_8h.html#ace1c20370b1b0dfbc4d4468b2d3f6e8f" title="Reference thread. ">thread_ref</a> and <a class="el" href="thread_8h.html#ab80d8d7b90162b1fef24baa08a4593ba" title="Destroy thread. ">thread_destroy</a> in <a class="el" href="thread_8h.html" title="Threads. ">thread.h</a>. Implicitly allocated objects does not need to be initialized/finalized.</p>
<p>Reference counted data types have a predefined maximum number of concurrently allocated objects defined in <a class="el" href="build_8h.html" title="Build setup. ">build.h</a> named BUILD_SIZE_&lt;module&gt;_MAP, for example <a class="el" href="build_8h.html#a1e41bc0f1a65a87285fc48025bc58078" title="Maximum threads. ">BUILD_SIZE_THREAD_MAP</a> for threads. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
