<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Foundation Library: D:/foundation_lib/foundation/memory.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Foundation Library
   &#160;<span id="projectnumber">1.4.0</span>
   </div>
   <div id="projectbrief">Cross-platform application foundation library in C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5c02a266b809652a081fe9248161d9c6.html">foundation</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">memory.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="platform_8h_source.html">foundation/platform.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="types_8h_source.html">foundation/types.h</a>&gt;</code><br />
</div>
<p><a href="memory_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5b6293bb8de0c3536d709078af6516a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memory_8h.html#a5b6293bb8de0c3536d709078af6516a6">memory_allocate</a> (<a class="el" href="types_8h.html#afc91d3cceff94258bb6566969046caa5">hash_t</a> context, size_t size, unsigned int align, unsigned int hint)</td></tr>
<tr class="separator:a5b6293bb8de0c3536d709078af6516a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bd508a88e4038925b50735058fc9a61"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memory_8h.html#a6bd508a88e4038925b50735058fc9a61">memory_reallocate</a> (void *p, size_t size, unsigned int align, size_t oldsize)</td></tr>
<tr class="separator:a6bd508a88e4038925b50735058fc9a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a864f02081eda0b24e2e722be5ae47af6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memory_8h.html#a864f02081eda0b24e2e722be5ae47af6">memory_deallocate</a> (void *p)</td></tr>
<tr class="separator:a864f02081eda0b24e2e722be5ae47af6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecf73c835a7383428712d36d65500f88"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memory_8h.html#aecf73c835a7383428712d36d65500f88">memory_context_push</a> (<a class="el" href="types_8h.html#afc91d3cceff94258bb6566969046caa5">hash_t</a> context)</td></tr>
<tr class="separator:aecf73c835a7383428712d36d65500f88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a514f98a2bbadd1e2582b2875ce006314"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memory_8h.html#a514f98a2bbadd1e2582b2875ce006314">memory_context_pop</a> (void)</td></tr>
<tr class="separator:a514f98a2bbadd1e2582b2875ce006314"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f212613d2a398a5d89be9fa3669639e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> <a class="el" href="types_8h.html#afc91d3cceff94258bb6566969046caa5">hash_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memory_8h.html#a8f212613d2a398a5d89be9fa3669639e">memory_context</a> (void)</td></tr>
<tr class="separator:a8f212613d2a398a5d89be9fa3669639e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa8e9796968a92101a45386c896c4cdb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memory_8h.html#aaa8e9796968a92101a45386c896c4cdb">memory_context_thread_finalize</a> (void)</td></tr>
<tr class="separator:aaa8e9796968a92101a45386c896c4cdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3324f63c3c7e17acd6e96e6992523b19"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memory_8h.html#a3324f63c3c7e17acd6e96e6992523b19">memory_set_tracker</a> (<a class="el" href="structmemory__tracker__t.html">memory_tracker_t</a> tracker)</td></tr>
<tr class="separator:a3324f63c3c7e17acd6e96e6992523b19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cdd643827126cba0545efae21df85f8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> <a class="el" href="structmemory__system__t.html">memory_system_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memory_8h.html#a4cdd643827126cba0545efae21df85f8">memory_system_malloc</a> (void)</td></tr>
<tr class="separator:a4cdd643827126cba0545efae21df85f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acba93c06358b42939f31e09d63815e19"><td class="memItemLeft" align="right" valign="top"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> <a class="el" href="structmemory__tracker__t.html">memory_tracker_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="memory_8h.html#acba93c06358b42939f31e09d63815e19">memory_tracker_local</a> (void)</td></tr>
<tr class="separator:acba93c06358b42939f31e09d63815e19"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Memory allocation and deallocation. The actual implementation of allocation/deallocation can be controlled with the memory system declaration given to <a class="el" href="foundation_8h.html#afa623d6638b10ee1d68b88b101b30def">foundation_initialize</a> at startup.</p>
<p>Memory allocation/deallocation can be tracked with memory_set_tracker if the build configuration <a class="el" href="build_8h.html#a999773b6eb8f1b6f3cf0663bbe5b6af2">BUILD_ENABLE_MEMORY_TRACKER</a> is set to 1. If not, all memory tracker calls are statically removed at compile time.</p>
<p>Memory can be tracked by context, set as a hash value (usually a static string hash) if the build configuration <a class="el" href="build_8h.html#a123163940bda0609bc624f38d38a9a4b">BUILD_ENABLE_MEMORY_CONTEXT</a> is set to 1. If not, all memory context calls are statically removed and context 0 is used everywhere. Memory contexts are stored per thread. </p>

<p>Definition in file <a class="el" href="memory_8h_source.html">memory.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a5b6293bb8de0c3536d709078af6516a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void* memory_allocate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#afc91d3cceff94258bb6566969046caa5">hash_t</a>&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>align</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>hint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate memory. Memory will be aligned to the given alingment unless set to 0, which will cause alignment to be ignored. Memory hints can be given to allow the memory system to make better choises of how to allocate the memory. If context is 0, the currently set memory context scope is used (see <a class="el" href="memory_8h.html#a8f212613d2a398a5d89be9fa3669639e">memory_context</a>, <a class="el" href="memory_8h.html#aecf73c835a7383428712d36d65500f88">memory_context_push</a> and <a class="el" href="memory_8h.html#a514f98a2bbadd1e2582b2875ce006314">memory_context_pop</a>) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>Memory context </td></tr>
    <tr><td class="paramname">size</td><td>Requested size </td></tr>
    <tr><td class="paramname">align</td><td>Requested alignment </td></tr>
    <tr><td class="paramname">hint</td><td>Hint flags </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Memory address to a memory block of the requested size and alignment, 0 if out of memory </dd></dl>

</div>
</div>
<a class="anchor" id="a6bd508a88e4038925b50735058fc9a61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void* memory_reallocate </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>align</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>oldsize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reallocate a memory block. Old memory content will be preserved, and if requested size is larger than the current size the new memory area above the old size will be uninitialized. The currently set memory context is used for any allocation. It is safe to pass null as the current memory block pointer. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Current memory block pointer </td></tr>
    <tr><td class="paramname">size</td><td>New requested size </td></tr>
    <tr><td class="paramname">align</td><td>New requested alignment </td></tr>
    <tr><td class="paramname">oldsize</td><td>Previous size </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Memory address to a (potentially new) memory block of the requested size and alignment, 0 if out of memory </dd></dl>

</div>
</div>
<a class="anchor" id="a864f02081eda0b24e2e722be5ae47af6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void memory_deallocate </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deallocate a memory block. Safe to pass a null pointer. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">p</td><td>Memory block pointer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aecf73c835a7383428712d36d65500f88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void memory_context_push </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#afc91d3cceff94258bb6566969046caa5">hash_t</a>&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set a new current memory context by pushing it onto the context stack. A call to <a class="el" href="memory_8h.html#a514f98a2bbadd1e2582b2875ce006314">memory_context_pop</a> will restore the previous memory context. Memory context stack is thread-local, setting a new memory context will not affect the current memory context of any other thread. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>New memory context </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a514f98a2bbadd1e2582b2875ce006314"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void memory_context_pop </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pop the current memory context off the context stack and set the new current memory context to the previous memory context (the one below on the context stack). If no previous memory context is available on the stack, the current memory context is set to 0. </p>

</div>
</div>
<a class="anchor" id="a8f212613d2a398a5d89be9fa3669639e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> <a class="el" href="types_8h.html#afc91d3cceff94258bb6566969046caa5">hash_t</a> memory_context </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the current memory context, or 0 if no context is set </p><dl class="section return"><dt>Returns</dt><dd>Current memory context </dd></dl>

</div>
</div>
<a class="anchor" id="aaa8e9796968a92101a45386c896c4cdb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void memory_context_thread_finalize </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cleanup and deallocate any memory used for thread-local memory context data. Called internally when a foundation thread is about to exit. </p>

</div>
</div>
<a class="anchor" id="a3324f63c3c7e17acd6e96e6992523b19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> void memory_set_tracker </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmemory__tracker__t.html">memory_tracker_t</a>&#160;</td>
          <td class="paramname"><em>tracker</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the current memory tracker, see <a class="el" href="memory_8h.html#acba93c06358b42939f31e09d63815e19">memory_tracker_local</a> for a default implementation </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tracker</td><td>New memory tracker declaration </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a4cdd643827126cba0545efae21df85f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> <a class="el" href="structmemory__system__t.html">memory_system_t</a> memory_system_malloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the default malloc based memory system declaration for passing to <a class="el" href="foundation_8h.html#afa623d6638b10ee1d68b88b101b30def">foundation_initialize</a> </p><dl class="section return"><dt>Returns</dt><dd>Default malloc based memory system declation </dd></dl>

</div>
</div>
<a class="anchor" id="acba93c06358b42939f31e09d63815e19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="platform_8h.html#ab5d798081ff1e38fc8d86a56b852da8e">FOUNDATION_API</a> <a class="el" href="structmemory__tracker__t.html">memory_tracker_t</a> memory_tracker_local </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the default local memory tracker declaration for passing to <a class="el" href="memory_8h.html#a3324f63c3c7e17acd6e96e6992523b19">memory_set_tracker</a> </p><dl class="section return"><dt>Returns</dt><dd>Default local memory tracker declaration </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
